{"ast":null,"code":"import _regeneratorRuntime from \"/home/thanhphong/Downloads/VueJS/MoneyManager/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/home/thanhphong/Downloads/VueJS/MoneyManager/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport { ref } from \"vue\";\nimport { projectStorage } from \"@/configs/firebase\";\nimport { useUser } from \"./useUser\";\n\nvar _useUser = useUser(),\n    getUser = _useUser.getUser;\n\nvar _getUser = getUser(),\n    user = _getUser.user;\n\nvar useStorage = function useStorage(name) {\n  var error = ref(null);\n  var filePath = ref(null);\n  var url = ref(null);\n\n  function uploadFile(_x) {\n    return _uploadFile.apply(this, arguments);\n  }\n\n  function _uploadFile() {\n    _uploadFile = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(file) {\n      var fileRef, response;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              filePath.value = \"\".concat(name, \"/\").concat(user.value.uid, \"/\").concat(file.name);\n              console.log(filePath);\n              fileRef = projectStorage.ref(filePath.value);\n              console.log(fileRef);\n              _context.prev = 4;\n              _context.next = 7;\n              return fileRef.put(file);\n\n            case 7:\n              response = _context.sent;\n              _context.next = 10;\n              return response.ref.getDownloadURL();\n\n            case 10:\n              url.value = _context.sent;\n              return _context.abrupt(\"return\", url.value);\n\n            case 14:\n              _context.prev = 14;\n              _context.t0 = _context[\"catch\"](4);\n              console.log(_context.t0);\n              error.value = _context.t0.message;\n\n            case 18:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[4, 14]]);\n    }));\n    return _uploadFile.apply(this, arguments);\n  }\n\n  return {\n    error: error,\n    filePath: filePath,\n    url: url,\n    uploadFile: uploadFile\n  };\n};\n\nexport default useStorage;","map":{"version":3,"names":["ref","projectStorage","useUser","getUser","user","useStorage","name","error","filePath","url","uploadFile","file","value","uid","console","log","fileRef","put","response","getDownloadURL","message"],"sources":["/home/thanhphong/Downloads/VueJS/MoneyManager/src/composables/useStorage.js"],"sourcesContent":["import { ref } from \"vue\";\nimport { projectStorage } from \"@/configs/firebase\";\nimport { useUser } from \"./useUser\";\n\nconst { getUser } = useUser();\nconst { user } = getUser();\nconst useStorage = (name) => {\n    const error = ref(null);\n    const filePath = ref(null);\n    const url = ref(null);\n\n    async function uploadFile(file) {\n        filePath.value = `${name}/${user.value.uid}/${file.name}`;\n        console.log(filePath);\n        const fileRef = projectStorage.ref(filePath.value);\n        console.log(fileRef);\n        try {\n            const response = await fileRef.put(file);\n            url.value = await response.ref.getDownloadURL();\n            return url.value;\n\n        } catch (err) {\n            console.log(err);\n            error.value = err.message;\n        }\n    }\n\n    return { error, filePath, url, uploadFile };\n};\n\nexport default useStorage;"],"mappings":";;;;AAAA,SAASA,GAAT,QAAoB,KAApB;AACA,SAASC,cAAT,QAA+B,oBAA/B;AACA,SAASC,OAAT,QAAwB,WAAxB;;AAEA,eAAoBA,OAAO,EAA3B;AAAA,IAAQC,OAAR,YAAQA,OAAR;;AACA,eAAiBA,OAAO,EAAxB;AAAA,IAAQC,IAAR,YAAQA,IAAR;;AACA,IAAMC,UAAU,GAAG,SAAbA,UAAa,CAACC,IAAD,EAAU;EACzB,IAAMC,KAAK,GAAGP,GAAG,CAAC,IAAD,CAAjB;EACA,IAAMQ,QAAQ,GAAGR,GAAG,CAAC,IAAD,CAApB;EACA,IAAMS,GAAG,GAAGT,GAAG,CAAC,IAAD,CAAf;;EAHyB,SAKVU,UALU;IAAA;EAAA;;EAAA;IAAA,yEAKzB,iBAA0BC,IAA1B;MAAA;MAAA;QAAA;UAAA;YAAA;cACIH,QAAQ,CAACI,KAAT,aAAoBN,IAApB,cAA4BF,IAAI,CAACQ,KAAL,CAAWC,GAAvC,cAA8CF,IAAI,CAACL,IAAnD;cACAQ,OAAO,CAACC,GAAR,CAAYP,QAAZ;cACMQ,OAHV,GAGoBf,cAAc,CAACD,GAAf,CAAmBQ,QAAQ,CAACI,KAA5B,CAHpB;cAIIE,OAAO,CAACC,GAAR,CAAYC,OAAZ;cAJJ;cAAA;cAAA,OAM+BA,OAAO,CAACC,GAAR,CAAYN,IAAZ,CAN/B;;YAAA;cAMcO,QANd;cAAA;cAAA,OAO0BA,QAAQ,CAAClB,GAAT,CAAamB,cAAb,EAP1B;;YAAA;cAOQV,GAAG,CAACG,KAPZ;cAAA,iCAQeH,GAAG,CAACG,KARnB;;YAAA;cAAA;cAAA;cAWQE,OAAO,CAACC,GAAR;cACAR,KAAK,CAACK,KAAN,GAAc,YAAIQ,OAAlB;;YAZR;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA,CALyB;IAAA;EAAA;;EAqBzB,OAAO;IAAEb,KAAK,EAALA,KAAF;IAASC,QAAQ,EAARA,QAAT;IAAmBC,GAAG,EAAHA,GAAnB;IAAwBC,UAAU,EAAVA;EAAxB,CAAP;AACH,CAtBD;;AAwBA,eAAeL,UAAf"},"metadata":{},"sourceType":"module"}